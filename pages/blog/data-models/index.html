<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.241">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ran Li">
<meta name="dcterms.date" content="2023-01-25">

<title>Structured SALURBAL Data/Metadata: a primer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../../../site_libs/viz-1.8.2/viz.js"></script>
<link href="../../../site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="../../../site_libs/grViz-binding-1.0.9/grViz.js"></script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo.png" alt="SALURBAL logo." class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">
 <span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../pages/fair/index.html">
 <span class="menu-text">FAIR Implementation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../pages/database/qc.html">
 <span class="menu-text">Database</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/LACUrbanHealth"><i class="bi bi-twitter" role="img" aria-label="SALURBAL Twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Drexel-UHC/salurbal-project-dashboard"><i class="bi bi-github" role="img" aria-label="SALURBAL GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Structured SALURBAL Data/Metadata: a primer</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#salurbal-data" id="toc-salurbal-data" class="nav-link active" data-scroll-target="#salurbal-data">SALURBAL Data</a></li>
  <li><a href="#intro-to-relational-database" id="toc-intro-to-relational-database" class="nav-link" data-scroll-target="#intro-to-relational-database">Intro to relational database</a></li>
  <li><a href="#salurbal-metadata-schemas" id="toc-salurbal-metadata-schemas" class="nav-link" data-scroll-target="#salurbal-metadata-schemas">SALURBAL Metadata Schemas</a>
  <ul class="collapse">
  <li><a href="#apsl1ad" id="toc-apsl1ad" class="nav-link" data-scroll-target="#apsl1ad">APSL1AD</a></li>
  <li><a href="#lemedian" id="toc-lemedian" class="nav-link" data-scroll-target="#lemedian">LEMEDIAN</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Drexel-UHC/salurbal-project-dashboard/edit/main/pages/blog/data-models/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/Drexel-UHC/salurbal-project-dashboard/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Structured SALURBAL Data/Metadata: a primer</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">This post provides a primer on the SALURBAL data model and how we go from an unstructured collection of data/metadata to a structured database.</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ran Li </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="salurbal-data" class="level1">
<h1>SALURBAL Data</h1>
<p>For us the fundamental data unit is a single data point. In this regard we store SALURBAL data as a data frame in adherence with <a href="https://r4ds.had.co.nz/tidy-data.html">tidy data principles</a>:</p>
<ol type="1">
<li>Each characteristic of the data point must have its own column</li>
<li>Each data point must have its own row</li>
<li>Each value must hvae its own cell</li>
</ol>
<p>Below is an example of tidy SALURBAL data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datamodelr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">ranli</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">Git local</span><span class="sc">\\</span><span class="st">SALURBAL Dashboard Portal</span><span class="sc">\\</span><span class="st">data-pipeline</span><span class="sc">\\</span><span class="st">clean</span><span class="sc">\\</span><span class="st">cleaned_datasets.rdata"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">=</span> cleaned_datasets<span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var_name,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">strata_id =</span> var_name_nested,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">salid =</span> salid1,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>         year,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>         value) <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample_n(4)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">183204</span>,<span class="dv">256165</span>,<span class="dv">59134</span>,<span class="dv">145255</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>i) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strata_id =</span> <span class="fu">ifelse</span>(strata_id <span class="sc">==</span> var_name,<span class="cn">NA</span>, strata_id))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>df_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">var_name</th>
<th style="text-align: left;">strata_id</th>
<th style="text-align: left;">salid</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PRJPOP</td>
<td style="text-align: left;">PRJPOP_M</td>
<td style="text-align: left;">562839</td>
<td style="text-align: left;">2009</td>
<td style="text-align: left;">878633</td>
</tr>
<tr class="even">
<td style="text-align: left;">SVYHTMED</td>
<td style="text-align: left;">SVYHTMED_TOT_PL-SAL</td>
<td style="text-align: left;">343574</td>
<td style="text-align: left;">2003</td>
<td style="text-align: left;">0.172495680497369</td>
</tr>
<tr class="odd">
<td style="text-align: left;">APSPM25MEDIAN</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">562474</td>
<td style="text-align: left;">2004</td>
<td style="text-align: left;">10.199999809</td>
</tr>
<tr class="even">
<td style="text-align: left;">BECTPOP</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">562333</td>
<td style="text-align: left;">2009</td>
<td style="text-align: left;">157306</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The table above is a simplified example of tidy SALURBAL data. For each of the four data points we have a unique variable identifier <code>var_name</code>, population strata information <code>strata_id</code>, salurbal id <code>salid</code>, year of data point <code>year</code> and the <code>value</code> of the data point.</p>
<p>Looking across the first row. We can see the variable is <code>PRJPOP_M</code>, is not stratified, has SALURBAL ID of <code>562839</code>, is for the year <code>2009</code> and has a value of <code>878633</code>.</p>
<p>Each row is called an observation aka a single SALURBAL data point. Each column is an attribute of the specific data point aka observation. Each cell is considered a value of a attribute/column combination.</p>
<p>In other words. - Each observation is a SALURBAL data point. - Observations are represented as rows. - Attributes of each observation are represented as columns. - There is exactly one type of observational unit per table.</p>
<p>A dataset is a collection of values. Each value below to both a attribute and observation. A variable contains all values that measure the same attribute across units. An observation contains all values measured onet he same unit across attributes.</p>
<p><strong>Now that we have this datastructure, we need to link metadata to these data points. SALURBAL metadata is stored within a relational database schema</strong></p>
</section>
<section id="intro-to-relational-database" class="level1">
<h1>Intro to relational database</h1>
<p>A relational database is just a collection of flat files (tables) that have relationships with each other. There are two basic building blocks to a relational database: <strong>tables</strong> and <strong>fields</strong>.Tables have fields (aka columns). These fields have relationship to fields in other tables. How do we show these relationships. So how do we show that?</p>
<p>A nice simple way of doing this is to take each table and make a rectangle out of it, listing all the fields we know about.</p>
<p>For example the SALURBAL data table and a codebook table can be represented as:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-template.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"TB"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-b4182cf76a8d009f55ed" style="width:100%;height:417px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-b4182cf76a8d009f55ed">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=TB tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\nsubgraph cluster_1 {\nlabel=\"Metadata\"\ncolor=\"#DDDDDD\"\n  \"Codebook\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#787878\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#A5A5A5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">Codebook<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_name<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">domain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">subdomain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_label<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_def<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">value_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">coding<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">strata_description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">source<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_notes<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">limitations<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">acknowledgements<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_data<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_codebook<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">longitudinal<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">public<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">censor<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">license<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">fair<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n}\n\n  \"Data\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">Data<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">var_name<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">var_name_raw<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">iso2<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">strata_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">geo<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">salid1<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">year<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>How do we represent the relationship between these two tables? In come primary keys and foreign keys.</strong></p>
<ul>
<li><strong>Primary key (underlined)</strong> is a unique identifier for each entity (e.g.&nbsp;student or class) in a table. It is used to uniquely identify each record in the table and to establish relationships with other tables.</li>
<li><strong>Foreign key (labeled with ~)</strong> is a field in a table that references the primary key of another table. It is used to establish a link between data in two tables and to enforce referential integrity. A foreign key in one table corresponds to the primary key of another table, creating a relationship between the two tables.</li>
</ul>
<p><strong>We can use an metadata schematic aka schema aka entity-relationship (ER) diagram to show the relationship between the tables in our database.</strong></p>
</section>
<section id="salurbal-metadata-schemas" class="level1">
<h1>SALURBAL Metadata Schemas</h1>
<p>For SALURBAL, during this renovation process we have found that the metadata availability and the relationship of the metadata to our data varies depending on the dataset. During the renovation process we capture this relationship in a CSV table called linkage.csv.</p>
<p>Below are some examples of the types of relationships we have encountered; both schematics and linkage.csv is used to shown these relationships.</p>
<section id="apsl1ad" class="level2">
<h2 class="anchored" data-anchor-id="apsl1ad">APSL1AD</h2>
<p>The Air Pollution dataset APSL1AD is an example of a simple metadata to data relationship. The schema and linkage.csv are displayed here; interpretations of the schema can be found below.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Schema</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">linkage.csv</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-aps.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"LR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-e7474c670845f50dca0e" style="width:100%;height:417px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e7474c670845f50dca0e">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\nsubgraph cluster_1 {\nlabel=\"Metadata\"\ncolor=\"#DDDDDD\"\n  \"codebook_by_var\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#787878\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#A5A5A5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">codebook_by_var<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">~<\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><U>var_name<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">domain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">subdomain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_label<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_def<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">value_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">coding<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">strata_description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">source<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_notes<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">limitations<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">acknowledgements<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_data<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_codebook<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">longitudinal<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">public<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">censor<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">license<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">fair<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n}\n\n  \"Data\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">Data<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>var_name<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>var_name_raw<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>iso2<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>strata_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>geo<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>salid1<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>year<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"codebook_by_var\"->\"Data\"\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/Drexel-UHC/salurbal-fair-renovations/main/datasets/APSL1AD/3-linkage.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">'lcccc'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: center;">by_var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dataset_id</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">domain</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">subdomain</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">var_label</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">var_def</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">value_type</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">units</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">coding</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">strata_description</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">source</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dataset_notes</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">limitations</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">acknowledgements</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">file_data</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">file_codebook</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">longitudinal</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">public</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">censor</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">license</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">fair</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<section id="data" class="level4">
<h4 class="anchored" data-anchor-id="data">Data</h4>
<p>Every row in our Data table is a unique SALURBAL data point. This unique data point can be identified by using a combination of primary keys which are underlined.</p>
</section>
<section id="metadata" class="level4">
<h4 class="anchored" data-anchor-id="metadata">Metadata</h4>
<p>We only have one type of linkage in this dataset. All our metadata fields can be linked by the field <code>var_name</code>; so we only have one metadata table <code>codebook_by_var</code>.</p>
<ul>
<li><code>codebook_by_var.var_name</code> is a primary key because every observation/row in this table will have a different <code>var_name</code>. This primary key is underlined.</li>
<li><code>codebook_by_var.var_name</code> is a foreign key because it is a field used to establish a link to a primary key within our Data table. This foreign key is labeled with a ~.</li>
</ul>
</section>
</section>
<section id="lemedian" class="level2">
<h2 class="anchored" data-anchor-id="lemedian">LEMEDIAN</h2>
<p>The Life Expectancy dataset (LEMEDIAN) is an example of a slightly more complex metadata to data relationship. The schema and linkage.csv are displayed here; interpretations of the schema can be found below.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Schema</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">linkage.csv</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-lemedian.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"LR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-15343e535675414d8914" style="width:100%;height:557px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-15343e535675414d8914">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\nsubgraph cluster_1 {\nlabel=\"Metadata\"\ncolor=\"#DDDDDD\"\n  \"codebook_by_var\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#787878\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#A5A5A5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">codebook_by_var<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">~<\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><U>var_name<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">domain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">subdomain<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_label<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">var_def<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">value_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">coding<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">strata_description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">dataset_notes<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">limitations<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">acknowledgements<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_data<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">file_codebook<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">longitudinal<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">censor<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">license<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">fair<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n}\n\nsubgraph cluster_1 {\nlabel=\"Metadata\"\ncolor=\"#DDDDDD\"\n  \"codebook_by_var_iso2\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#787878\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#A5A5A5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">codebook_by_var_iso2<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">~<\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><U>var_name<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">~<\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><U>iso2<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">year<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">source<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E4E4E4\">public<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n}\n\n  \"Data\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"2\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">Data<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>var_name<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>var_name_raw<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>iso2<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>strata_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>geo<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><U>salid1<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\"><\/TD>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\">value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"codebook_by_var\"->\"Data\"\n\"codebook_by_var_iso2\"->\"Data\"\n\"codebook_by_var_iso2\"->\"Data\"\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/Drexel-UHC/salurbal-fair-renovations/main/datasets/LEMEDIAN_L1/3-linkage.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">field =</span> field <span class="sc">%&gt;%</span> <span class="fu">str_remove_all</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">t'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">'lcccc'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: center;">by_var</th>
<th style="text-align: center;">by_var_iso2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dataset_id</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">domain</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">subdomain</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">var_label</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">var_def</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">value_type</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">units</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">coding</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">strata_description</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">source</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dataset_notes</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">limitations</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">acknowledgements</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">file_data</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">file_codebook</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">longitudinal</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">public</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">censor</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">license</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">fair</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">year</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<section id="data-1" class="level4">
<h4 class="anchored" data-anchor-id="data-1">Data</h4>
<p>Every row in our Data table is a unique SALURBAL data point. This unique data point can be identified by using a combination of primary keys which are underlined.</p>
<p>Note that the original data CSV file for LEMEDIAN is cross sectional and does not include year information. So in this case, year is going actually a piece of metadata we bring in linked by var_name and iso2.</p>
</section>
<section id="metadata-1" class="level4">
<h4 class="anchored" data-anchor-id="metadata-1">Metadata</h4>
<p>We have two types of linkage in this dataset. So we have two metadata tables <code>codebook_by_var</code> and <code>codebook_by_var_iso2</code>.</p>
<ul>
<li><code>codebook_by_var.var_name</code> is a <strong>primary key (underlined)</strong> because every observation/row in this table will have a different <code>var_name</code>. It is also a <strong>foreign key (~)</strong> because it is a field used to establish a link to a primary key within our Data table.</li>
<li><code>codebook_by_var_iso2.var_name</code> and <code>codebook_by_var_iso2.iso2</code> are <strong>primary keys (underlined)</strong> because there be one and only one row for each combination of iso2 and var_name. They are also a <strong>foreign key (~)</strong> because we will use them to establish a link to a primary key within our Data table.</li>
</ul>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Structured SALURBAL Data/Metadata: a primer "</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "This post provides a primer on the SALURBAL data model and how we go from an unstructured collection of data/metadata to a structured database."</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ran Li"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-01-25" </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># SALURBAL Data</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>For us the fundamental data unit is a single data point. In this regard we store SALURBAL data as a data frame in adherence with <span class="co">[</span><span class="ot">tidy data principles</span><span class="co">](https://drexel-uhc.github.io/salurbal-fair-renovations/pages/blog/tidy-data/)</span>:</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Each characteristic of the data point must have its own column</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Each data point must have its own row</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Each value must hvae its own cell</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>Below is an example of tidy SALURBAL data. </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datamodelr)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">ranli</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">Git local</span><span class="sc">\\</span><span class="st">SALURBAL Dashboard Portal</span><span class="sc">\\</span><span class="st">data-pipeline</span><span class="sc">\\</span><span class="st">clean</span><span class="sc">\\</span><span class="st">cleaned_datasets.rdata"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">=</span> cleaned_datasets<span class="sc">%&gt;%</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var_name,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">strata_id =</span> var_name_nested,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">salid =</span> salid1,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>         year,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>         value) <span class="sc">%&gt;%</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample_n(4)</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">183204</span>,<span class="dv">256165</span>,<span class="dv">59134</span>,<span class="dv">145255</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>i) <span class="sc">%&gt;%</span> </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strata_id =</span> <span class="fu">ifelse</span>(strata_id <span class="sc">==</span> var_name,<span class="cn">NA</span>, strata_id))</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>df_data</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>The table above is a simplified example of tidy SALURBAL data. For each of the four data points we have a unique variable identifier <span class="in">`var_name`</span>, population strata information <span class="in">`strata_id`</span>, salurbal id <span class="in">`salid`</span>, year of data point <span class="in">`year`</span> and the <span class="in">`value`</span> of the data point. </span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>Looking across the first row. We can see the variable is <span class="in">`PRJPOP_M`</span>, is not stratified, has SALURBAL ID of <span class="in">`562839`</span>, is for the year <span class="in">`2009`</span> and has a value of <span class="in">`878633`</span>. </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>Each row is called an observation aka a single SALURBAL data point. Each column is an attribute of the specific data point aka observation. Each cell is considered a value of a attribute/column combination.</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>In other words. </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each observation is a SALURBAL data point. </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Observations are represented as rows.</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Attributes of each observation are represented as columns. </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is exactly one type of observational unit per table.</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>A dataset is a collection of values. Each value below to both a attribute and observation. A variable contains all values that measure the same attribute across units. An observation contains all values measured onet he same unit across attributes.  </span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>**Now that we have this datastructure, we need to link metadata to these data points. SALURBAL metadata is stored within a relational database schema**</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Intro to relational database  </span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>A relational database is just a collection of flat files (tables) that have relationships with each other. There are two basic building blocks to a relational database: **tables** and **fields**.Tables have fields (aka columns). These fields have relationship to fields in other tables. How do we show these relationships. So how do we show that?</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>A nice simple way of doing this is to take each table and make a rectangle out of it, listing all the fields we know about. </span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>For example the SALURBAL data table and a codebook table can be represented as:</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height=4.5</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-template.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"TB"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>()</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>**How do we represent the relationship between these two tables? In come primary keys and foreign keys.**</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Primary key (underlined)** is a unique identifier for each entity (e.g. student or class) in a table. It is used to uniquely identify each record in the table and to establish relationships with other tables.</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Foreign key (labeled with ~)** is a field in a table that references the primary key of another table. It is used to establish a link between data in two tables and to enforce referential integrity. A foreign key in one table corresponds to the primary key of another table, creating a relationship between the two tables.</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>**We can use an metadata schematic aka schema aka entity-relationship (ER) diagram to show the relationship between the tables in our database.** </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="fu"># SALURBAL Metadata Schemas</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>For SALURBAL, during this renovation process we have found that the metadata availability and the relationship of the metadata to our data varies depending on the dataset. During the renovation process we capture this relationship in a CSV table called linkage.csv. </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>Below are some examples of the types of relationships we have encountered; both schematics and linkage.csv is used to shown these relationships. </span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## APSL1AD</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>The Air Pollution dataset APSL1AD  is an example of a simple metadata to data relationship. The schema and linkage.csv are displayed here; interpretations of the schema can be found below. </span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Schema</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height=4.5</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-aps.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"LR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>()</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## linkage.csv</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/Drexel-UHC/salurbal-fair-renovations/main/datasets/APSL1AD/3-linkage.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">'lcccc'</span>)</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data</span></span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>Every row in our Data table is a unique SALURBAL data point. This unique data point can be identified by using a combination of primary keys which are underlined. </span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Metadata</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>We only have one type of linkage in this dataset. All our metadata fields can be linked by the field <span class="in">`var_name`</span>; so we only have one metadata table  <span class="in">`codebook_by_var`</span>. </span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`codebook_by_var.var_name`</span> is a primary key because every observation/row in this table will have a different <span class="in">`var_name`</span>. This primary key is underlined. </span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`codebook_by_var.var_name`</span> is a foreign key because it is a field used to establish a link to a primary key within our Data table. This foreign key is labeled with a ~. </span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## LEMEDIAN</span></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>The Life Expectancy dataset (LEMEDIAN)  is an example of a slightly more complex metadata to data relationship. The schema and linkage.csv are displayed here; interpretations of the schema can be found below. </span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Schema</span></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height=6</span></span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_read_yaml</span>(<span class="st">"salurbal-lemedian.yml"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_create_graph</span>(<span class="at">rankdir =</span> <span class="st">"LR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>() </span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## linkage.csv</span></span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/Drexel-UHC/salurbal-fair-renovations/main/datasets/LEMEDIAN_L1/3-linkage.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">field =</span> field <span class="sc">%&gt;%</span> <span class="fu">str_remove_all</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">t'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">'lcccc'</span>)</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data</span></span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>Every row in our Data table is a unique SALURBAL data point. This unique data point can be identified by using a combination of primary keys which are underlined. </span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>Note that the original data CSV file for LEMEDIAN is cross sectional and does not include year information. So in this case, year is going actually a piece of metadata we bring in linked by var_name and iso2. </span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Metadata</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>We have two types of linkage in this dataset. So we have two metadata tables  <span class="in">`codebook_by_var`</span> and <span class="in">`codebook_by_var_iso2`</span>.</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`codebook_by_var.var_name`</span> is a **primary key (underlined)** because every observation/row in this table will have a different `var_name`. It is also a **foreign key (~)** because it is a field used to establish a link to a primary key within our Data table.</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`codebook_by_var_iso2.var_name`</span> and <span class="in">`codebook_by_var_iso2.iso2`</span> are **primary keys (underlined)** because there be one and only one row for each combination of iso2 and var_name. They are also a **foreign key (~)** because we will use them to establish a link to a primary key within our Data table.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/LACUrbanHealth">
      <i class="bi bi-twitter" role="img" aria-label="SALURBAL Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Drexel-UHC/salurbal-project-dashboard">
      <i class="bi bi-github" role="img" aria-label="SALURBAL GitHub">
</i> 
    </a>
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>